function Export2Doc(t,e){var o="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>"+document.getElementById(t).innerHTML+"</body></html>",a=new Blob(["\ufeff",o],{type:"application/msword"}),l="data:application/vnd.ms-word;charset=utf-8,"+encodeURIComponent(o);e=e?e+".doc":"document.doc";var n=document.createElement("a");document.body.appendChild(n),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(a,e):(n.href=l,n.download=e,n.click()),document.body.removeChild(n)}$.get("./fgdfgadjavdadasdasdasdbnvashdgasd.csv",function(t){processCsvData(t)},"text");var allData={},typeOfReports=[];function processCsvData(t){for(var e=CSV.parse(t),o=1;o<e.length;o++){var a,l,n,r=e[o][1],s=e[o][0],i=e[o][2],p=e[o][3];switch(void 0===allData[r]?(n=[],0==p.trim().length?n.push(i):((a={})[i]=p,n.push(a)),(l={})[s]=n,allData[r]=l):((l={})[i]=p,null!=allData[r][s]?allData[r][s].push(0==p.trim().length?i:l):(n=[],0==p.trim().length?n.push(i):n.push(l),allData[r][s]=n)),e[o][0]){case"REPORT_TYPE":typeOfReports.push(e[o])}}console.log(allData),populateReportTypes(),populateAllAutoSuggestionBoxes()}function populateReportTypes(){for(var t=0;t<typeOfReports.length;t++)optionText=typeOfReports[t][2],optionValue=typeOfReports[t][1],$("#typeOfReport").append('<option value="'+optionValue+'"> '+optionText+"</option>")}function populateReportData(){var t=$("#typeOfReport").val(),e={OBSERVATION:"observations",IMPRESSION:"impressions",PROTOCOL:"protocols",CONCLUSION:"conclusions",SUGGESTION:"suggestions"};for(var o in e)populateCheckBoxes(t,o,e[o]),populateAllAutoSuggestionBoxes(t,o,e[o]);$("#r_reportName").text(allData[t].REPORT_TYPE)}function populateCheckBoxes(t,e,o){var a="";if(null!=allData[t]){var l=allData[t][e];if(null!=l)for(var n=0;n<l.length;n++)a=a+'<div class="form-group form-check"><label class="form-check-label"><input class="form-check-input" type="checkbox" name="'+e+'_ChkBox" value="'+l[n]+'">'+l[n]+"</label></div>"}$("#"+o).html(a)}function populateAllAutoSuggestionBoxes(t,e,o){if(null!=allData[t]){var a=allData[t]["SHORT_CUT_"+e];if(null!=a){for(var l=[],n=0;n<a.length;n++)for(var r in a[n])l.push(r+"@@@@"+a[n][r]);l=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,local:l});$("#autoCompleteBox_"+o).typeahead({hint:!0,highlight:!0,minLength:1},{name:"newArr",source:l})}}}function clearData(t){$("#"+t).val("")}function generateReport(){var t=$("#typeOfReport").val();$("#r_reportName").text(allData[t].REPORT_TYPE);var e=getSelectedItems("PROTOCOL",!1);$("#r_protocol").html("<strong>Protocol: </strong>"+e);var o=getSelectedItems("OBSERVATION",!0);0!=o.trim().length&&$("#r_observations").html("<br><strong>Observations: </strong><ul>"+o+"</ul>");var a=getSelectedItems("IMPRESSION",!0);0!=a.trim().length&&$("#r_impressions").html("<br><strong>Impression: </strong><ul>"+a+"</ul>");var l=getSelectedItems("CONCLUSION",!1);0!=l.trim().length&&$("#r_conclusion").html("<br><strong>Conclusion: </strong><ul>"+l+"</ul>");var n=getSelectedItems("SUGGESTION",!1);0!=n.trim().length&&$("#r_suggestions").html("<br>"+n),$("#r_signature").html("<br>Dr. Gokul Kathade, <br>Consultant Radiologist,<br>M.D. Radiology (Sion, Mumbai),<br>dr.gokul.kathade@gmail.com")}function getSelectedItems(t,e){var o="",a=[];$("input:checkbox[name="+t+"_ChkBox]:checked").each(function(){a.push($(this).val())});for(var l=0;l<a.length;l++){var n=a[l];e?n="<li>"+n+"</li>":n+="<br>",o+=n}return o}function addTypedOptions(t,e){var o=$("#autoCompleteBox_"+t).val();-1!=o.indexOf("@@@@")&&(o=o.split("@@@@")[1]);var a=[];$("input:checkbox[name="+e+"_ChkBox]:checked").each(function(){a.push($(this).val())});var l=(l=$("#"+t).html())+'<div class="form-group form-check"><label class="form-check-label"><input class="form-check-input" type="checkbox" name="'+e+'_ChkBox" value="'+o+'" checked>'+o+"</label></div>";$("#"+t).html(l);for(var n=0;n<a.length;n++)$("input:checkbox[value='"+a[n]+"']").prop("checked",!0)}function exportWord(){Export2Doc("exportContent",getReportName())}function exportPDF(){var t=$("#patientName").val(),e=new Date,o="<div style='text-align: left'><span><strong>Name Of Patient: </strong>"+t+"</span></div><div style='text-align: right;'><span><strong>Date: </strong>"+(e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear())+"</span></div><br>";$("#r_ptName").html(o);var a=$("#exportContent").html(),l=window.open("","","height=400,width=800");l.document.write("<html><head><title>"+getReportName()+"</title>"),l.document.write("</head><body>"),l.document.write(a),l.document.write("</body></html>"),l.document.close(),l.print()}function getReportName(){var t=$("#patientName").val(),e=new Date,o=e.getDate()+"_"+(e.getMonth()+1)+"_"+e.getFullYear(),a=$("#typeOfReport").val();return 0!=t.trim().length&&(t=t.split(" ").join("_")+"_"),t+o+"_"+a}